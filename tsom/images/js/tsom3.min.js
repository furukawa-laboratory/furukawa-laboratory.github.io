(function(){queue().defer(d3.text,"./data/w.txt").defer(d3.csv,"./data/l1.csv").defer(d3.csv,"./data/l2.csv").defer(d3.csv,"./data/l3.csv").defer(d3.text,"./data/rate1.txt").defer(d3.text,"./data/rate2.txt").defer(d3.text,"./data/rate3.txt").defer(d3.text,"./data/mode1attrdata.txt").defer(d3.json,"./data/mode1attrlabel.json").defer(d3.text,"./data/mode2attrdata.txt").defer(d3.json,"./data/mode2attrlabel.json").defer(d3.text,"./data/mode3attrdata.txt").defer(d3.json,"./data/mode3attrlabel.json").defer(d3.json,
"./data/parameter.json").defer(d3.text,"./data/dim.txt").await(function(kb,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,R,$a){function ab(b){var a,d;if(-1===S[b])pa=!1;else{pa=!0;var c=S[b],h=C[b].length;for(d=0;d<p;d++){var l=0;for(a=K[d]=0;a<h;a++)K[d]+=C[b][a][c]*L[b][a][d],l+=L[b][a][d];K[d]/=l;isNaN(K[d])&&(K[d]=0)}console.log(K)}}function qa(b){for(var a=0;a<Object.keys(M[b]).length;a++)S[b][a]=-1,D[b][a].select("input").property("checked",!0)}function H(){for(var b=0;3>b;b++)ha[b].text(function(a){var d,
c="",h=!1;[0,1,2].filter(function(a){return a!==b}).forEach(function(a,b){m[a].flag&&(h&&(c+=","),h=!0,c+="\u7279\u5b9a\u306e"+ra[a]+"("+m[a].unit+")")});h&&(c+="\u306b\u3064\u3044\u3066\u306e");c+=a+"\u306e";0===v[b]?c=-1!==n?c+(V[n+1]+"\u306b\u95a2\u3059\u308b\u985e\u4f3c\u5ea6"):c+"\u985e\u4f3c\u5ea6":1===v[b]?c=-1!==n?c+(V[n+1]+"\u306b\u95a2\u3059\u308b\u8a55\u4fa1\u5024"):c+"\u5168\u8a55\u4fa1\u306e\u5e73\u5747\u5024":2===v[b]&&(c=-1!==n?c+(V[n+1]+"\u306b\u95a2\u3059\u308b\u8a55\u4fa1\u5024"):
c+"\u5168\u8a55\u4fa1\u306e\u5e73\u5747\u5024");if(-1===v[b]){a=[];for(d=0;d<C[b].length;d++)a[d]=!0;for(var c="\u5c5e\u6027\u306e\u5206\u5e03(",l=0;l<sa[b];l++)if(-1!==S[b][l])for(d=Object.keys(M[b])[l],c+=d+":"+M[b][d][S[b][l]]+" ",d=0;d<C[b].length;d++)!0===a[d]&&0===C[b][d][Ba[b][l][S[b][l]]]&&(a[d]=!1);var g=0;a.forEach(function(a){!0===a&&(g+=1)});c+=" \u8a08"+g+"\u4eba)"}return c})}function T(b){0===v[b]?(W[b].transition().style("opacity",0),Ca(b)):1===v[b]?(W[b].transition().style("opacity",
1),ja(b)):2===v[b]&&(W[b].transition().style("opacity",1),ja(b))}function ta(b,a){E[a].select(".focus").transition().duration(30).attr("cx",b.x).attr("cy",b.y).attr("r",k).style("opacity",1);m[a].unit=b.j*t+b.i;ka(b,a)}function ka(b,a){aa[a].selectAll(".pic").style("display",function(d,c){if(null===b||!d3.select("input#attrlabel"+a+"_input").property("checked")||!m[a].flag)return"none";var h=b.j*t+b.i;return"none"!==d.imgType&&h===Number(d.unit)?"inline":"none"})}function bb(){E.forEach(function(b,
a){if(m[a].flag){var d=m[a].unit%t,c=Math.floor(m[a].unit/t);b.selectAll(".cpHexagon").filter(function(a){return a.i===d&&a.j===c}).each(function(b){ta(b,a)})}})}function ua(b){for(var a=0;3>a;a++)b!==a&&(0===v[a]?Ca(a):1===v[a]?ja(a):2===v[a]&&ja(a))}function Ca(b){cb(b);Da[b].style("fill",function(a,d){return Ea(F[b][d])})}function cb(b){var a=[0,1,2].filter(function(a){return a!==b}),d=m[a[0]].flag,a=m[a[1]].flag,c,h=[],l=0,g=0,ia=0,f,q,e,k;if(d||a||!va[b]||-1!==n){for(f=0;f<z;f++)for(q=0;q<U;q++)if(0!==
f%2||0!==q%2)3===q%4?(c=Math.floor(q/2)*t+Math.floor(f/2),e=Math.ceil(q/2)*t+Math.ceil(f/2)):(c=Math.ceil(q/2)*t+Math.floor(f/2),e=Math.floor(q/2)*t+Math.ceil(f/2)),c=db(b,c,e),h[q*z+f]=c,l+=c,g+=c*c,ia+=1;for(f=0;f<z;f++)for(q=0;q<U;q++)if(0===f%2&&0===q%2){for(e=c=X=0;6>e;e++)k=Fa(f,q,e),-1!==k&&(c+=h[k],X+=1);c/=X;h[q*z+f]=c;l+=c;g+=c*c;ia+=1}l/=ia;g=Math.sqrt(g/ia-Math.pow(l,2));for(f=0;f<z;f++)for(q=0;q<U;q++)if(0===f%2&&0===q%2)F[b][q*z+f]=h[q*z+f];else{for(e=c=X=0;6>e;e++)k=Fa(f,q,e),-1!==
k&&(c+=h[k],X+=1);c=(c+h[q*z+f])/(X+1);F[b][q*z+f]=c}for(f=0;f<la;f++)F[b][f]=(F[b][f]-l)/(4*g)+.5,0>F[b][f]&&(F[b][f]=0),1<F[b][f]&&(F[b][f]=1);if(!d&&!a&&!va[b]){for(f=0;f<la;f++)Ga[b][f]=F[b][f];va[b]=!0}}else for(f=0;f<la;f++)F[b][f]=Ga[b][f]}function db(b,a,d){var c,h,l,g,e=[0,1,2].filter(function(a){return a!==b});g=m[e[0]].flag;h=m[e[0]].unit;c=m[e[1]].flag;l=m[e[1]].unit;e=0;if(g&&c)if(-1!==n)e=Math.pow(r(b,a,h,l,n)-r(b,d,h,l,n),2);else for(g=0;g<A;g++)e+=Math.pow(r(b,a,h,l,g)-r(b,d,h,l,g),
2);else if(g&&!c)if(-1!==n)for(c=0;c<p;c++)e+=Math.pow(r(b,a,h,c,n)-r(b,d,h,c,n),2);else for(c=0;c<p;c++)for(g=0;g<A;g++)e+=Math.pow(r(b,a,h,c,g)-r(b,d,h,c,g),2);else if(!g&&c)if(-1!==n)for(c=0;c<p;c++)e+=Math.pow(r(b,a,c,l,n)-r(b,d,c,l,n),2);else for(c=0;c<p;c++)for(g=0;g<A;g++)e+=Math.pow(r(b,a,c,l,g)-r(b,d,c,l,g),2);else if(!g&&!c)if(-1!==n)for(h=0;h<p;h++)for(l=0;l<p;l++)e+=Math.pow(r(b,a,h,l,n)-r(b,d,h,l,n),2);else for(h=0;h<p;h++)for(l=0;l<p;l++)for(g=0;g<A;g++)e+=Math.pow(r(b,a,h,l,g)-r(b,
d,h,l,g),2);return Math.sqrt(e)}function Fa(b,a,d){var c,h;switch(d){case 0:c=b+(1===a%4||2===a%4?1:0);h=a-1;break;case 1:c=b+1;h=a;break;case 2:c=b+(2===a%4||3===a%4?1:0);h=a+1;break;case 3:c=b-1+(2===a%4||3===a%4?1:0);h=a+1;break;case 4:c=b-1;h=a;break;case 5:c=b-1+(1===a%4||2===a%4?1:0),h=a-1}return 0>c||c>=z||0>h||h>=U?-1:h*z+c}function ja(b){var a=[0,1,2].filter(function(a){return a!==b}),d=m[a[0]].flag,c=m[a[0]].unit,h=m[a[1]].flag,e=m[a[1]].unit;1===v[b]&&W[b].style("fill",function(a,l){var f,
g,k,m;if(d&&h)if(-1!==n)f=r(b,l,c,e,n);else{for(m=f=0;m<A;m++)f+=r(b,l,c,e,m);f/=A}else if(d&&!h)if(-1!==n){for(g=f=0;g<p;g++)f+=r(b,l,c,g,n);f/=p}else{for(g=f=0;g<p;g++)for(m=0;m<A;m++)f+=r(b,l,c,g,m);f/=p*A}else if(!d&&h)if(f=0,-1!==n){for(g=0;g<p;g++)f+=r(b,l,g,e,n);f/=p}else{for(g=0;g<p;g++)for(m=0;m<A;m++)f+=r(b,l,g,e,m);f/=p*A}else if(!d&&!h)if(f=0,-1!==n){for(g=0;g<p;g++)for(k=0;k<p;k++)f+=r(b,l,g,k,n);f/=p*p}else{for(g=0;g<p;g++)for(k=0;k<p;k++)for(m=0;m<A;m++)f+=r(b,l,g,k,m);f/=p*p*A}return Ha(f)})}
function r(b,a,d,c,h){if(0===b)return w[a][d][c][h];if(1===b)return w[d][a][c][h];if(2===b)return w[d][c][a][h]}var e,u,N,ba,w=Na.replace(/\r/g,"").replace(/\n+$/g,"").split("\n\n\n");for(e=0;e<w.length;e++)for(w[e]=w[e].split("\n\n"),u=0;u<w[e].length;u++)for(w[e][u]=w[e][u].split("\n"),N=0;N<w[e][u].length;N++)for(w[e][u][N]=w[e][u][N].split(" "),ba=0;ba<w[e][u][N].length;ba++)w[e][u][N][ba]=parseFloat(w[e][u][N][ba]);var L=[Ra,Sa,Ta];L.forEach(function(b,a){L[a]=b.replace(/\r/g,"").replace(/\n+$/g,"").split("\n");L[a].forEach(function(b,
c){L[a][c]=b.split(" ");L[a][c].forEach(function(b,d){L[a][c][d]=parseFloat(L[a][c][d])})})});var C=[Ua,Wa,Ya];C.forEach(function(b,a){C[a]=b.replace(/\r/g,"").replace(/\n+$/g,"").split("\n");C[a].forEach(function(b,c){C[a][c]=b.split(" ");C[a][c].forEach(function(b,d){C[a][c][d]=parseFloat(C[a][c][d])})})});var M=[Va,Xa,Za],Ba=[[],[],[]],sa=[],X=0;M.forEach(function(b,a){for(var d in b)Ba[a][d]=d;sa[a]=b.length});var S=[-1,-1,-1],x=[Oa,Pa,Qa],Y=[d3.layout.force(),d3.layout.force(),d3.layout.force()],V=$a.replace(/\r/g,"").replace(/\n+$/g,
"").split("\n"),A=V.length;V.unshift("\u5168\u3066\u306e\u6b21\u5143");var n=-1,ra=[R.input.mode1_name,R.input.mode2_name,R.input.mode3_name],t=R.parameter.unit_num_x,O=R.parameter.unit_num_y,p=t*O,z=2*t-1,U=2*O-1,la=z*U;d3.interpolateHslLong=function(b,a){b=d3.hsl(b);a=d3.hsl(a);var d=b.h,c=b.s,h=b.l,e=a.h-d,g=a.s-c,k=a.l-h;return function(a){return d3.hsl(d+e*a,c+g*a,h+k*a).rgb().toString()}};var Ia=R.input.min_value,Ja=R.input.max_value,eb=(Ia+Ja)/2,Ea=d3.interpolateHslLong("blue","red"),Ha=d3.scale.linear().domain([Ia,
eb,Ja]).range(["blue","white","red"]),fb=d3.scale.linear().domain([0,1]).range(["white","black"]),gb=["U-Matrix","Score"],v=[0,0,0],m=[{unit:0,flag:!1},{unit:0,flag:!1},{unit:0,flag:!1}],F=[[],[],[]],Ga=[[],[],[]],va=[!1,!1,!1],K=[],pa=!1,wa=0;1<A&&(wa=200);var B=(window.innerWidth-wa-48)/3,P=window.innerHeight-140,k=d3.max([d3.min([B/((t-.5)*Math.sqrt(3)+4),2*P/(3*(O-1)+8)]),13.5]),G=k/2,B=k*(Math.sqrt(3)*(t-.5)+4),P=k*(3*(O-1)/2+4),ca=d3.hexbin().radius(k),da=[],y=[];for(e=0;e<O;e++)for(u=0;u<t;u++)da.push([k*
u*1.75,k*e*1.5]),y.push({x:k*(u+e%2*.5)*Math.sqrt(3),y:k*e*1.5,unit:e*t+u});var ea=d3.hexbin().radius(G),fa=[],xa=[];for(e=0;e<U;e++)for(u=0;u<z;u++)fa.push([G*(u+Math.abs((e+2)%4-2)/2)*Math.sqrt(3),G*e*1.5]),xa.push({x:G*(u+Math.abs((e+2)%4-2)/2)*Math.sqrt(3),y:G*e*1.5});x.forEach(function(b,a){x[a].forEach(function(b,c){x[a][c].x=y[b.unit].x;x[a][c].y=y[b.unit].y})});Y.forEach(function(b,a){Y[a]=d3.layout.force().nodes(x[a]).charge(0).gravity(0).size([B-4*k,P-4*k])});var ya=d3.select("#chart").style("display",
"flex").style("flex-direction","row"),Ka=ya.selectAll("div").data(ra).enter().append("div").attr("class","modeChart bordered"),Q=Ka.append("div").attr("id",function(b,a){return"map"+a}).text(function(b){return b+"\u30de\u30c3\u30d7"}).style("min-width",B+"px");Q.append("br");var ha=[];Q.each(function(b,a){ha[a]=d3.select(this).append("div").style("width",B+"px").style("height","60px").attr("class","info bordered").text(function(a,c){return b+"\u306e\u985e\u4f3c\u5ea6"})});["um","cp"].forEach(function(b,
a){Q.append("input").attr("id",function(a,c){return"mm"+c+b}).attr("class",function(){return b+"radio"}).attr("type","radio").attr("name",function(a,b){return"radio"+b}).property("checked",function(){return 0===a}).datum("visualizeModeInput");Q.append("label").attr("for",function(a,c){return"mm"+c+b}).text(function(){return gb[a]});Q.append("br")});var ma=Q.append("svg").attr("width",B).attr("height",P),I=ma.append("g").attr("transform","translate("+(1+Math.sqrt(3)/2)*k+","+2*k+")"),E=[];for(e=0;3>
e;e++)E.push(I.filter(function(b,a){return a===e}));Q.append("br");var hb=I.selectAll(".uHexagon").data(ea(fa)).enter().append("path").attr("class","uHexagon").style("stroke","black").style("stroke-width",1).style("fill",function(b,a){return Ea(a/la)}).attr("d",function(b){return"M"+b.x+","+b.y+ea.hexagon()}),ib=I.selectAll(".cpHexagon").data(ca(da)).enter().append("path").attr("class","cpHexagon").style("opacity",.3).style("stroke","black").style("stroke-width",1).style("fill",function(b,a){return Ha(a/
p*5)}).attr("d",function(b){return"M"+b.x+","+b.y+ca.hexagon()}),jb=I.selectAll(".dot").data(y).enter().append("circle").attr("class","dot").attr("cx",function(b){return b.x}).attr("cy",function(b){return b.y}).attr("r","1px").style("pointer-events","none");I.each(function(b,a){var d=this;x[a].forEach(function(a){if("input"!==a.attr)return!0;d3.select(d).selectAll(".dot").filter(function(b){return b.unit===Number(a.unit)}).attr("r","4px")})});I.each(function(b,a){d3.select(this).selectAll(".label").data(x[a]).enter().append("text").attr("class",
"label").attr("text-anchor","middle").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("font-family","Meiryo UI").attr("font-weight","bolder").attr("font-size",.5*k).attr("fill","#000").attr("stroke-width",2).attr("stroke","#FFF").attr("paint-order","stroke").text(function(a){return a.label}).style("pointer-events","none").style("display",function(a){return"input"===a.attr?"inline":"none"})});Y.forEach(function(b,a){b.on("tick",function(b){var c=.1*b.alpha;x[a].forEach(function(a,
b){a.y+=(y[a.unit].y-a.y)*c;a.x+=(y[a.unit].x-a.x)*c});E[a].selectAll(".label").attr("x",function(a){return a.x}).attr("y",function(a){return a.y})})});Y.forEach(function(b){b.start()});var Da=[],W=[];for(e=0;3>e;e++)Da.push(I.filter(function(b,a){return a===e}).selectAll(".uHexagon")),W.push(I.filter(function(b,a){return a===e}).selectAll(".cpHexagon"));var J=B/3,na=Ka.append("div").style("display","flex").style("flex-direction","row"),La=na.filter(function(b,a){return 0<sa[a]}).append("div").attr("class",
"addition").style("width",J+"px").text("\u5c5e\u6027\u306e\u5206\u5e03\u8868\u793a");La.append("br");var Ma=[];na.each(function(b,a){Ma[a]=d3.select(this).append("div").attr("class","addition").style("width",J+"px").text("\u8868\u793a\u30e9\u30d9\u30eb").append("div").attr("class","bordered")});Ma.forEach(function(b,a){b.append("input").attr("class","attrlabel").attr("id","attrlabel"+a+"_no").attr("type","radio").attr("name","attrlabel"+a).property("checked",!1).datum(-1);b.append("label").attr("for",
"attrlabel"+a+"_no").text("\u30e9\u30d9\u30eb\u975e\u8868\u793a");b.append("br");b.append("input").attr("class","attrlabel").attr("id","attrlabel"+a+"_input").attr("type","radio").attr("name","attrlabel"+a).property("checked",!0).datum("input");b.append("label").attr("for","attrlabel"+a+"_input").text("\u5165\u529b\u30c7\u30fc\u30bf");b.append("br");for(var d in M[a]){var c=M[a][d];b.append("input").attr("class","attrlabel").attr("id","attrlabel"+a+"_"+c).attr("type","radio").attr("name","attrlabel"+
a).datum(c);b.append("label").attr("for","attrlabel",+a+"_"+c).text(c);b.append("br")}b.selectAll(".attrlabel").on("change",function(b,c){E[a].selectAll(".label").transition().attr("font-size",function(a){return a.attr===b?.5*k:0}).each("start",function(){d3.select(this).style("display",function(a){return a.attr===b?"inline":"default"}).attr("font-size",function(a){return a.attr===b?0:"default"})}).each("end",function(){d3.select(this).style("display",function(a){return a.attr===b?"default":"none"})});
E[a].selectAll(".dot").attr("r","1px");x[a].forEach(function(c){if(c.attr!==b)return!0;E[a].selectAll(".dot").filter(function(a){return a.unit===Number(c.unit)}).transition().attr("r",function(a){return"4px"})});var d={};d.i=m[a].unit%t;d.j=Math.floor(m[a].unit/t);ka(d,a)})});var aa=[];na.each(function(b,a){aa[a]=d3.select(this).append("div").attr("class","addition").style("width",J+"px").text("\u753b\u50cf");aa[a].selectAll(".pic").data(function(){var b=[];x[a].forEach(function(a,d){"none"!==a.imgType&&
b.push(a)});return b}).enter().append("img").attr("class","pic").attr("width",J+"px").style("display","none")});var Z=[];aa.forEach(function(b,a){Z[a]=[];b.selectAll(".pic").filter(function(a){return"none"!==a.imgType}).each(function(b,c){var d=d3.select(this),e=UnescapeUTF8(EscapeSJIS(b.label));Z[a][c]=new Image;Z[a][c].src="./data/img/"+(a+1)+"/"+e+"."+b.imgType;Z[a][c].onload=function(){d.attr("src",Z[a][c].src)};Z[a][c].onerror=function(a){d.attr("src","./data/img/noimage.png").classed("noimage",
!0)}}).text(function(a){return a.label})});var D=[[],[],[]];D.forEach(function(b,a){D[a]=La.filter(function(b,c){return ra[a]===b}).append("div").style("float","left").style("border","1px solid black").style("padding-right","10px").style("height","auto").style("width",J-20+"px").style("background","#DDD");D[a].append("input").attr("id",function(){return a+"--1\u6307\u5b9a\u306a\u3057"}).attr("class","attrradio"+a).attr("type","radio").attr("name",function(){return"attrradio"+a}).property("checked",
!0).datum(-1);D[a].append("label").attr("for",function(){return a+"--1\u6307\u5b9a\u306a\u3057"}).text("\u5c5e\u6027\u306e\u6307\u5b9a\u306a\u3057");D[a].append("br");for(var d in M[a]){var c=M[a][d];D[a].append("input").attr("id",function(){return a+"-"+d+c}).attr("class","attrradio"+a).attr("type","radio").attr("name",function(){return"attrradio"+a}).datum(c);D[a].append("label").attr("for",function(){return a+"-"+d+c}).text(function(){return c});D[a].append("br")}D[a].selectAll(".attrradio"+a).on("change",
function(b,c){S[a]=c-1;v[a]=1;T(a);ab(a);pa?(W[a].style("fill",function(a,b){return fb(K[b])}),d3.select("#map"+a).selectAll("input").property("checked",function(a){if("visualizeModeInput"===a)return!1}),v[a]=1,ha[a].text(function(){return b+"\u306e\u5206\u5e03"})):(v[a]=1,T(a),d3.select("#map"+a).select(".cpradio").property("checked",!0),H())})});var za,Aa;1<A&&(za=ya.append("div").attr("class","bordered").text("\u6b21\u5143\u306e\u6307\u5b9a"),za.append("br"),Aa=za.append("select").attr("name",
"dim"),Aa.selectAll("option").data(V).enter().append("option").attr("value",function(b,a){return a-1}).text(function(b){return b}),Aa.on("change",function(b){n=parseInt(d3.select(this).property("value"));for(b=0;3>b;b++)T(b);H()}));for(e=0;3>e;e++)v[e]=0,T(e);d3.selectAll(".umradio").on("change",function(b,a){v[a]=0;T(a);qa(a);H()});d3.selectAll(".cpradio").on("change",function(b,a){v[a]=1;T(a);qa(a);H()});d3.selectAll(".cprradio").on("change",function(b,a){v[a]=2;T(a);qa(a);H()});var oa=!1,ga=!1;
d3.select("body").on("mouseup",function(){oa=!1});ya.selectAll("div").on("mouseleave",function(){oa=!1});d3.select("body").on("mousedown",function(){oa=!0});ma.each(function(b,a){d3.select(this).selectAll(".cpHexagon").on("mouseover",function(b){oa&&m[a].flag&&(ta(b,a),ua(a),H(),d3.event.preventDefault())})});ma.each(function(b,a){d3.select(this).selectAll(".cpHexagon").on("mousedown",function(b){m[a].flag?m[a].unit===b.j*t+b.i?ga=!0:(ga=!1,ta(b,a),H()):(ga=!1,m[a].flag=!0,E[a].selectAll(".focus").remove(),
E[a].append("circle").attr("class","focus").attr("cx",b.x).attr("cy",b.y).style("fill","none").style("stroke","green").style("stroke-width",3).style("opacity",0).attr("r",3*k).transition().attr("r",k).style("opacity",1),m[a].unit=b.j*t+b.i,ka(b,a),H());ua(a);H();d3.event.preventDefault()});d3.select(this).selectAll(".cpHexagon").on("click",function(b){m[a].flag&&m[a].unit===b.j*t+b.i&&ga&&(ga=!1,m[a].flag=!1,E[a].selectAll(".focus").transition().attr("r",3*k).style("opacity",0).remove(),ka(null,a),
ua(a),H(),d3.event.preventDefault())})});d3.select(window).on("resize",function(b){var a;B=(window.innerWidth-wa-48)/3;P=window.innerHeight-140;k=d3.max([d3.min([B/((t-.5)*Math.sqrt(3)+4),2*P/(3*(O-1)+8)]),13.5]);G=k/2;B=k*(Math.sqrt(3)*(t-.5)+4);P=k*(3*(O-1)/2+4);ca=d3.hexbin().radius(k);da=[];y=[];for(b=0;b<O;b++)for(a=0;a<t;a++)da.push([k*a*1.75,k*b*1.5]),y.push({x:k*(a+b%2*.5)*Math.sqrt(3),y:k*b*1.5,unit:b*t+a});ea=d3.hexbin().radius(G);fa=[];xa=[];for(b=0;b<U;b++)for(a=0;a<z;a++)fa.push([G*(a+
Math.abs((b+2)%4-2)/2)*Math.sqrt(3),G*b*1.5]),xa.push({x:G*(a+Math.abs((b+2)%4-2)/2)*Math.sqrt(3),y:G*b*1.5});Q.style("min-width",B+"px");I.attr("transform","translate("+(1+Math.sqrt(3)/2)*k+","+2*k+")");ma.attr("width",B).attr("height",P);ib.data(ca(da)).attr("d",function(a){return"M"+a.x+","+a.y+ca.hexagon()});hb.data(ea(fa)).attr("d",function(a){return"M"+a.x+","+a.y+ea.hexagon()});jb.data(y).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y});I.each(function(a,b){d3.select(this).selectAll(".label").attr("x",
function(a){return y[a.unit].x}).attr("y",function(a){return y[a.unit].y+.6*k}).attr("font-size",.5*k)});x.forEach(function(a,b){x[b].forEach(function(a,c){x[b][c].x=y[a.unit].x;x[b][c].y=y[a.unit].y})});Y.forEach(function(a,b){a.on("tick",function(a){var c=.1*a.alpha;x[b].forEach(function(a,b){a.y+=(y[a.unit].y-a.y)*c;a.x+=(y[a.unit].x-a.x)*c});E[b].selectAll(".label").attr("x",function(a){return a.x}).attr("y",function(a){return a.y})})});Y.forEach(function(a){a.start()});bb();J=B/3;D.forEach(function(a,
b){attributesBlocks[b].each(function(a,c){D[b][c].style("width",J-20+"px")})});na.each(function(a,b){ha[b].style("width",B+"px");d3.select(this).selectAll(".addition").style("width",J+"px");aa[b].style("width",J+"px").selectAll(".pic").style("width",J+"px")})})})})();